name = "shotsped"
main = "worker.js"
compatibility_date = "2024-01-01"
workers_dev = true

[triggers]
crons = ["*/5 * * * *"] # Run every 5 minutes for health checks

[routes]
# Uncomment and modify for custom domain deployment
# [[routes]]
# pattern = "your-domain.com/*"
# zone_name = "your-domain.com"

[vars]
ENVIRONMENT = "production"
API_VERSION = "1.0.0"

[build]
command = "echo 'Building VLES Trojan Worker...'"

[dev]
port = 8787
local_protocol = "https"

[placement]
mode = "smart"

# Memory and CPU limits
[limits]
cpu_ms = 200  # Increased for VLESS/Trojan protocol processing
memory = 256  # Increased for WebSocket connection handling

# WebSocket-specific configuration for VLESS and Trojan
[websocket]
enabled = true
max_connections = 100
idle_timeout = 300

# Protocol-specific optimizations
[protocol]
vless = { enabled = true, websocket = true }
trojan = { enabled = true, websocket = true }
